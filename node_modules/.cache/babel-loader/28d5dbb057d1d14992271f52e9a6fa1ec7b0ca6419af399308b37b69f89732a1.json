{"ast":null,"code":"import'./App.css';import React,{useEffect,useRef,useState}from'react';import useEmaCross from'./hooks/useEmaCross';import Alerts from'./components/Alerts';import Metrics from'./components/Metrics';import Controls from'./components/Controls';import DebugPanel from'./components/DebugPanel';import Notes from'./components/Notes';import Header from'./components/Header';import TopMenu from'./components/TopMenu';import ScannerPage from'./pages/ScannerPage';import scannerManager from'./lib/scannerManager';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function beep(){try{const AudioCtx=window.AudioContext||window.webkitAudioContext;const ctx=new AudioCtx();const o=ctx.createOscillator();const g=ctx.createGain();o.type='sine';o.frequency.value=880;o.connect(g);g.connect(ctx.destination);o.start();g.gain.setValueAtTime(0.0001,ctx.currentTime);g.gain.exponentialRampToValueAtTime(0.1,ctx.currentTime+0.01);g.gain.exponentialRampToValueAtTime(0.0001,ctx.currentTime+0.6);setTimeout(()=>{o.stop();try{ctx.close();}catch(e){}},700);}catch(e){// ignore\n}}function App(){const[symbol,setSymbol]=useState(()=>{try{const raw=localStorage.getItem('lastSymbol');if(raw&&typeof raw==='string')return raw.toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();}catch(e){}return'BTCUSDT';});const[autoStart,setAutoStart]=useState(true);const[symbolValid,setSymbolValid]=useState(null);// null=unknown, true/false\n// symbolValidateTimer moved into Controls component\nconst[availableSymbols,setAvailableSymbols]=useState(null);const[showDebug]=useState(false);const[suggestions,setSuggestions]=useState([]);// monitoring inputs (minutes + EMA short/long)\nconst[monitorMinutes,setMonitorMinutes]=useState(()=>{try{const raw=localStorage.getItem('lastMonitor');if(raw){const parsed=JSON.parse(raw);if(parsed&&typeof parsed.monitorMinutes!=='undefined')return Number(parsed.monitorMinutes)||5;}}catch(e){}return 5;});const[monitorEma1,setMonitorEma1]=useState(()=>{try{const raw=localStorage.getItem('lastMonitor');if(raw){const parsed=JSON.parse(raw);if(parsed&&typeof parsed.monitorEma1!=='undefined')return Number(parsed.monitorEma1)||26;}}catch(e){}return 26;});const[monitorEma2,setMonitorEma2]=useState(()=>{try{const raw=localStorage.getItem('lastMonitor');if(raw){const parsed=JSON.parse(raw);if(parsed&&typeof parsed.monitorEma2!=='undefined')return Number(parsed.monitorEma2)||200;}}catch(e){}return 200;});const[monitorConfirm]=useState(()=>{try{const raw=localStorage.getItem('lastMonitor');if(raw){const parsed=JSON.parse(raw);if(parsed&&typeof parsed.monitorConfirm!=='undefined')return Number(parsed.monitorConfirm)||1;}}catch(e){}// increase default confirmation to 2 closed candles to reduce false positives\nreturn 2;});const[marketCheckResult,setMarketCheckResult]=useState(null);// helper to fetch exchangeInfo and populate availableSymbols\nasync function fetchExchangeInfo(){try{// default to Binance Futures (USDT-M) exchangeInfo for symbols\nconst res=await fetch('https://fapi.binance.com/fapi/v1/exchangeInfo');if(!res.ok){console.warn('exchangeInfo fetch failed',res.status);setAvailableSymbols([]);return;}const data=await res.json();const syms=(data.symbols||[]).map(s=>s.symbol);setAvailableSymbols(syms);}catch(e){console.warn('exchangeInfo fetch error',e);setAvailableSymbols([]);}}// fetch full symbol list once on mount for reliable validation\n// fetch full symbol list once on mount for reliable validation\n// eslint-disable-next-line react-hooks/exhaustive-deps\nuseEffect(()=>{fetchExchangeInfo();},[]);// helper to validate a symbol (returns true/false)\nasync function validateSymbolOnce(s){const q=(s||'').replace(/[^A-Za-z0-9]/g,'').toUpperCase();if(!q)return false;// If we have a cached symbol list, compare using a normalized form (strip non-alnum, uppercase)\nif(availableSymbols&&availableSymbols.length>0){const normQ=q;for(const sym of availableSymbols){const normSym=(sym||'').replace(/[^A-Za-z0-9]/g,'').toUpperCase();if(normSym===normQ)return true;}return false;}// Fallback to exchangeInfo query for the single symbol\ntry{// fallback to Binance Futures exchangeInfo lookup\nconst res=await fetch(\"https://fapi.binance.com/fapi/v1/exchangeInfo?symbol=\".concat(q));if(!res.ok)return false;const data=await res.json();// if API returned an object with matching symbol(s), accept it\nif(data&&Array.isArray(data.symbols)&&data.symbols.length>0)return true;if(data&&data.symbol)return true;return false;}catch(e){return false;}}// if symbol becomes invalid, disable autoStart and disconnect to avoid wrong subscriptions\n// (moved below after hook initialization because it depends on connected/disconnect)\n// Disable hook autoConnect: App will control connecting so we can update server monitor symbol first\nconst{ema9,ema26,lastPrice,lastTick,lastCandleClosed,cross,confirmedCross,confirmedSource,connected,status,connect,disconnect,activeSymbol}=useEmaCross({symbol,autoConnect:true,debug:showDebug,interval:\"\".concat(monitorMinutes,\"m\"),emaShort:monitorEma1,emaLong:monitorEma2,confirmClosedCandles:monitorConfirm});const[events,setEvents]=useState([]);const[toast,setToast]=useState(null);// Helper: detect duplicate events and add only if not duplicate\n// Dedup logic: consider events duplicate if symbol + type match and their timestamps are within 5s,\n// or if price matches exactly and symbol+type match. This helps avoid server+client duplicate alerts.\nconst isDuplicateEvent=React.useCallback((newEv,existing)=>{try{if(!existing||!newEv)return false;const aSym=(existing.symbol||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();const bSym=(newEv.symbol||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();if(!aSym||!bSym||aSym!==bSym)return false;if((existing.type||'')!==(newEv.type||''))return false;// exact price match\nif(typeof existing.price!=='undefined'&&typeof newEv.price!=='undefined'&&String(existing.price)===String(newEv.price))return true;// timestamp proximity (use ts if available, otherwise parse time)\nconst aTs=typeof existing.ts==='number'?existing.ts:Date.parse(existing.time||'')||0;const bTs=typeof newEv.ts==='number'?newEv.ts:Date.parse(newEv.time||'')||0;if(aTs&&bTs&&Math.abs(aTs-bTs)<=5000)return true;}catch(e){}return false;},[]);const addEvent=React.useCallback(ev=>{setEvents(prev=>{try{if(Array.isArray(prev)&&prev.some(p=>isDuplicateEvent(ev,p))){if(showDebug)console.debug('[App] suppressed duplicate event',ev);return prev;}}catch(e){}return[ev,...prev].slice(0,500);});},[isDuplicateEvent,showDebug]);// Inform scannerManager about available symbols.\n// IMPORTANT: do NOT forward raw scanner \"results\" into the global Alerts/events list here.\n// Scanner results are shown on the separate Scanner page and should not be mixed with Alerts.\nuseEffect(()=>{try{scannerManager.setGetSymbols(()=>availableSymbols||[]);}catch(e){}},[availableSymbols]);const showToast=React.useCallback(function(message){let ok=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;try{setToast({message,ok,ts:Date.now()});// auto-dismiss after 5s\nsetTimeout(()=>{try{setToast(null);}catch(e){}},5000);}catch(e){}},[]);const lastNotified=useRef(null);const[sseConnected,setSseConnected]=useState(false);const[serverSymbol,setServerSymbol]=useState(null);const[lastHealthyAt,setLastHealthyAt]=useState(null);const[telegramConfigured,setTelegramConfigured]=useState(null);// null=unknown, true/false\nconst[view,setView]=useState('alerts');// serverUrl is provided at build-time via REACT_APP_SERVER_URL; when not set\n// the app should run in \"client-only\" mode (no SSE, no server Telegram relay).\n// Trim the env var to avoid accidental trailing-space issues embedding a bad URL\nconst _rawServerUrl=process.env.REACT_APP_SERVER_URL&&typeof process.env.REACT_APP_SERVER_URL==='string'?process.env.REACT_APP_SERVER_URL:'';// Default to same-origin when env var isn't provided so a single Render service works out of the box\nconst serverUrl=(()=>{const trimmed=(_rawServerUrl||'').trim();if(trimmed.length>0)return trimmed;try{if(typeof window!=='undefined'&&window.location&&window.location.origin){return window.location.origin;}}catch(e){}return null;})();// Debug helper: simulate a confirmed cross from the frontend (calls /send-alert and adds local event)\nconst simulateConfirmedCross=React.useCallback(forceType=>{try{const type=forceType||confirmedCross||'bull';const sym=(activeSymbol||symbol||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();const price=lastPrice||0;// Use configured EMA labels (monitorEma1/monitorEma2) in the message text\nconst text=\"\".concat(sym,\" \").concat(type==='bull'?\"Bullish EMA\".concat(monitorEma1,\" > EMA\").concat(monitorEma2):\"Bearish EMA\".concat(monitorEma1,\" < EMA\").concat(monitorEma2),\" @ \").concat(price);// add local event\nconst ev={ts:Date.now(),time:new Date().toLocaleString(),type:type==='bull'?'bull':'bear',price,symbol:sym,source:'client-sim'};addEvent(ev);// fire server send\n(async()=>{if(!serverUrl){// no server configured (static mode): inform user that Telegram relay is disabled\ntry{showToast('Telegram disabled: no server configured',false);}catch(e){}if(showDebug)console.debug('[App] simulateConfirmedCross skipped POST /send-alert because serverUrl is not set');return;}try{if(showDebug)console.debug('[App] simulate sending /send-alert',{url:\"\".concat(serverUrl,\"/send-alert\"),payload:{symbol:sym,price,message:text,emaShort:monitorEma1,emaLong:monitorEma2}});const res=await fetch(\"\".concat(serverUrl,\"/send-alert\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({symbol:sym,price,message:text,emaShort:monitorEma1,emaLong:monitorEma2})});let json=null;try{json=await res.json();}catch(e){json=null;}const sendEv={ts:Date.now(),time:new Date().toLocaleString(),type:'telegram_send',symbol:sym,source:'client-send',ok:res.ok,status:res.status,body:json};addEvent(sendEv);// show immediate toast to user\ntry{showToast(res.ok?\"Telegram send OK (\".concat(sym,\")\"):\"Telegram send failed (\".concat(res.status,\")\"),res.ok);}catch(e){}if(showDebug)console.debug('[App] simulate /send-alert response',sendEv);}catch(e){const errEv={ts:Date.now(),time:new Date().toLocaleString(),type:'telegram_send',symbol:sym,source:'client-send',ok:false,error:String(e)};addEvent(errEv);try{showToast(\"Telegram send error: \".concat(String(e)),false);}catch(err){}if(showDebug)console.debug('[App] simulate send-alert failed',e);}})();}catch(e){if(showDebug)console.debug('[App] simulateConfirmedCross error',e);}},[activeSymbol,symbol,lastPrice,addEvent,showDebug,confirmedCross,showToast,serverUrl,monitorEma1,monitorEma2]);// Subscribe to server-sent events from server (realtime alerts emitted by server)\nuseEffect(()=>{// If no server URL is configured (static/client-only), skip creating SSE\nif(!serverUrl){setSseConnected(false);return undefined;}if(!window.EventSource)return undefined;let es;try{es=new EventSource(\"\".concat(serverUrl,\"/events\"));es.onopen=()=>{setSseConnected(true);// fetch health once when SSE opens to sync server-side monitored symbol\ntry{fetch(\"\".concat(serverUrl,\"/health\")).then(r=>r.json()).then(j=>{if(j&&j.symbol)setServerSymbol((j.symbol||'').toString().toUpperCase());}).catch(()=>{});}catch(e){}};es.onmessage=e=>{try{const obj=JSON.parse(e.data);if(!obj)return;// handle server alert events and telegram_sent confirmations\nif(obj.type==='alert'){// prefer the activeSymbol from the hook, fallback to the selected symbol\nconst current=(activeSymbol||symbol||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();const incoming=(obj.symbol||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();// require incoming symbol to be present and match the currently-active symbol\nif(!incoming||!current||incoming!==current){if(showDebug)console.debug('[App] dropping SSE alert for different symbol',{incoming,current,obj});return;}const evObj={ts:obj.ts||Date.now(),time:obj.when?new Date(obj.when).toLocaleString():new Date().toLocaleString(),type:obj.alert==='bull'?'bull':'bear',price:obj.price,symbol:incoming,source:'server'};// use centralized dedupe/add helper\ntry{addEvent(evObj);}catch(e){setEvents(prev=>[evObj,...prev].slice(0,500));}}else if(obj.type==='telegram_sent'){// server confirmed it sent a telegram; add a small event so UI reflects it\ntry{const sym=(obj.symbol||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase()||(activeSymbol||symbol||'').toString().toUpperCase();const ev={ts:obj.ts||Date.now(),time:new Date(obj.ts||Date.now()).toLocaleString(),type:'telegram',price:obj.price||lastPrice,symbol:sym,source:'server-telegram',ok:obj.ok};addEvent(ev);}catch(e){}}}catch(err){}};es.onerror=()=>{setSseConnected(false);try{es.close();}catch(e){}};}catch(e){}return()=>{try{es&&es.close();}catch(e){}};},[symbol,activeSymbol,showDebug,addEvent,lastPrice,serverUrl]);// helper to ask server to monitor a symbol, then connect the client\nconst setServerAndConnect=React.useCallback(async(sym,opts)=>{const q=(sym||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();let interval=opts&&typeof opts.interval!=='undefined'?opts.interval:monitorMinutes;// normalize interval to a string accepted by Binance (e.g., '5m'). If a plain number is provided, treat as minutes.\nif(typeof interval==='number'||typeof interval==='string'&&/^\\d+$/.test(String(interval))){interval=\"\".concat(interval,\"m\");}const emaShort=opts&&typeof opts.emaShort!=='undefined'?opts.emaShort:monitorEma1;const emaLong=opts&&typeof opts.emaLong!=='undefined'?opts.emaLong:monitorEma2;const confirmCandles=opts&&typeof opts.confirmCandles!=='undefined'?opts.confirmCandles:monitorConfirm;if(!q){try{connect(sym);}catch(e){}return;}try{// update UI optimistically so the menu reflects the user's requested symbol\n// even if the server is temporarily unreachable. Then notify the server.\nsetServerSymbol(q);// call server endpoint to change monitored symbol and monitoring params\nconst paramsObj={symbol:q,interval:String(interval),emaShort:String(emaShort),emaLong:String(emaLong)};if(typeof confirmCandles!=='undefined'&&confirmCandles!==null)paramsObj.confirmCandles=String(confirmCandles);const params=new URLSearchParams(paramsObj);try{await fetch(\"\".concat(serverUrl,\"/set-symbol?\").concat(params.toString()),{method:'GET'});}catch(err){// server may be down; keep the optimistic UI state but inform user\ntry{showToast(\"Server set-symbol failed: \".concat(String(err)),false);}catch(e){}if(showDebug)console.debug('[App] /set-symbol request failed',err);}}catch(e){// ignore server errors and proceed to connect locally\n}try{connect(q);}catch(e){}// persist the last-used monitor inputs so Alerts/Controls can restore them\ntry{const toStore={monitorMinutes:typeof interval==='string'&&interval.endsWith('m')?Number(interval.replace(/m$/,'')):Number(interval),monitorEma1:Number(emaShort),monitorEma2:Number(emaLong),lastSymbol:q};localStorage.setItem('lastMonitor',JSON.stringify(toStore));}catch(e){}},[connect,monitorMinutes,monitorEma1,monitorEma2,monitorConfirm,showDebug,showToast,serverUrl]);// 자동 연결: symbol이 유효하고 autoStart가 켜져 있으면 Start 버튼을 누르지 않아도 connect 호출\nuseEffect(()=>{try{const q=(symbol||'').replace(/[^A-Za-z0-9]/g,'').toUpperCase();// only attempt auto-start after the hook has initialized its EMA seed\nif(q&&symbolValid===true&&autoStart&&status==='initialized'){if(!activeSymbol||activeSymbol.toString().toUpperCase()!==q){// ensure server monitor symbol is updated before connecting\ntry{setServerAndConnect(q);}catch(e){connect(q);}}}}catch(e){// ignore\n}},[symbol,symbolValid,autoStart,activeSymbol,connect,setServerAndConnect,status]);// fetch server health on mount in case SSE isn't available yet\nuseEffect(()=>{if(!serverUrl){// no server configured (static mode)\nsetTelegramConfigured(false);return;}try{fetch(\"\".concat(serverUrl,\"/health\")).then(r=>r.json()).then(j=>{if(j&&j.symbol)setServerSymbol((j.symbol||'').toString().toUpperCase());if(j){setLastHealthyAt(Date.now());if(typeof(j===null||j===void 0?void 0:j.telegramConfigured)!=='undefined')setTelegramConfigured(!!j.telegramConfigured);}}).catch(()=>{});}catch(e){}},[serverUrl]);// poll /health periodically so UI can show last healthy time; keeps serverSymbol and telegramConfigured in sync\nuseEffect(()=>{if(!serverUrl)return undefined;let mounted=true;async function poll(){try{const r=await fetch(\"\".concat(serverUrl,\"/health\"));if(!mounted)return;const j=await r.json();if(j&&j.symbol)setServerSymbol((j.symbol||'').toString().toUpperCase());if(j){setLastHealthyAt(Date.now());if(typeof(j===null||j===void 0?void 0:j.telegramConfigured)!=='undefined')setTelegramConfigured(!!j.telegramConfigured);}}catch(e){// keep lastHealthyAt as-is on error\n}}// initial poll\npoll();const id=setInterval(poll,15000);return()=>{mounted=false;clearInterval(id);};},[serverUrl]);// clearAlerts will be handled inline if needed; no export/import UI\n// --- localStorage에 Alerts 저장/복원 헬퍼 ---\nconst ALERTS_LS_KEY='alerts';function saveAlertsToLocalStorage(arr){try{if(!Array.isArray(arr))return;// 저장 크기 제한을 위해 최신 500개(로컬스토리지라 쿠키보다 여유)\nconst toStore=JSON.stringify(arr.slice(0,500));localStorage.setItem(ALERTS_LS_KEY,toStore);}catch(e){// ignore\n}}function loadAlertsFromLocalStorage(){try{const raw=localStorage.getItem(ALERTS_LS_KEY);if(!raw)return null;const parsed=JSON.parse(raw);if(Array.isArray(parsed))return parsed;return null;}catch(e){return null;}}// 복원: 마운트 시 localStorage에서 alerts 복원 (7일 초과 항목은 제거)\nuseEffect(()=>{try{const saved=loadAlertsFromLocalStorage();if(saved&&Array.isArray(saved)&&saved.length>0){const cutoff=Date.now()-1000*60*60*24*7;// 7 days\nconst normTarget=(symbol||'').replace(/[^A-Za-z0-9]/g,'').toUpperCase();const filtered=saved.filter(ev=>{if(!ev)return false;if(typeof ev.ts==='number'&&ev.ts<cutoff)return false;// try parse time string as fallback\nif(typeof ev.ts!=='number'){const parsed=Date.parse(ev.time||'');if(isNaN(parsed)||parsed<cutoff)return false;}// require event symbol to match the current selected symbol to avoid showing other-pair alerts\nconst evSym=(ev.symbol||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();return evSym===normTarget;});setEvents(filtered);}}catch(e){}},[symbol]);// Persist monitor inputs whenever they change so UI values are remembered\nuseEffect(()=>{try{const toStore={monitorMinutes,monitorEma1,monitorEma2,monitorConfirm,lastSymbol:symbol};localStorage.setItem('lastMonitor',JSON.stringify(toStore));}catch(e){}},[monitorMinutes,monitorEma1,monitorEma2,monitorConfirm,symbol]);// 저장: events가 바뀔 때마다 localStorage에 반영 (저장 전에 7일 초과 항목 제거)\nuseEffect(()=>{try{const cutoff=Date.now()-1000*60*60*24*7;// 7 days\nconst filtered=(events||[]).filter(ev=>{if(!ev)return false;if(typeof ev.ts==='number')return ev.ts>=cutoff;const parsed=Date.parse(ev.time||'');if(!isNaN(parsed))return parsed>=cutoff;return false;});saveAlertsToLocalStorage(filtered);}catch(e){}},[events]);// Alerts 항목 삭제 핸들러 (ts 기반으로 고유 항목 제거)\nfunction removeAlertByTs(ts){try{const next=(events||[]).filter(ev=>ev&&ev.ts!==ts);setEvents(next);}catch(e){}}// if symbol becomes invalid, disable autoStart and disconnect to avoid wrong subscriptions\nuseEffect(()=>{if(symbolValid===false){if(autoStart)setAutoStart(false);// ensure disconnected\nif(connected)disconnect();}// include dependencies to avoid stale closures\n},[symbolValid,autoStart,connected,disconnect]);// Ask for notification permission on first user interaction\nuseEffect(()=>{const handle=()=>{if('Notification'in window&&Notification.permission==='default'){Notification.requestPermission().then(()=>{});}window.removeEventListener('click',handle);};window.addEventListener('click',handle);return()=>window.removeEventListener('click',handle);},[]);// react to confirmed cross changes and notify (skip initial)\nuseEffect(()=>{if(!confirmedCross)return;// If the confirmed signal came from initial seeding, don't notify — treat as seeded state\nif(confirmedSource==='init'){// ensure we don't trigger notification for seed values\nlastNotified.current=confirmedCross;return;}if(lastNotified.current==null){// seed without notifying\nlastNotified.current=confirmedCross;return;}if(lastNotified.current!==confirmedCross){const type=confirmedCross==='bull'?\"Bullish EMA\".concat(monitorEma1,\" > EMA\").concat(monitorEma2):\"Bearish EMA\".concat(monitorEma1,\" < EMA\").concat(monitorEma2);const symToShowRaw=activeSymbol||symbol||'';const symToShow=(symToShowRaw||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();// Determine the authoritative price to show/send. Prefer closed-candle `lastPrice`,\n// but fall back to the most recent live tick (`lastTick`) when a closed price\n// isn't yet available. Still skip only when this is the initial seeded value.\nconst priceToUse=typeof lastPrice!=='undefined'&&lastPrice!==null?lastPrice:typeof lastTick!=='undefined'&&lastTick!==null?lastTick:null;if(confirmedSource==='init'){// do not notify for seed values\nlastNotified.current=confirmedCross;return;}if(priceToUse==null){// If we truly have no price at all, skip but log in debug so user can inspect\nif(showDebug)console.debug('[App] skipping notification: no price available (lastPrice & lastTick are null)',{confirmedCross,confirmedSource,activeSymbol,symbol});lastNotified.current=confirmedCross;return;}const body=\"\".concat(symToShow,\" \").concat(type,\" @ \").concat(priceToUse);// Also request the server to send a Telegram message for this confirmed cross.\n// In static/client-only mode (no serverUrl) skip server relay and show a toast.\n(async()=>{if(!serverUrl){try{showToast('Telegram disabled: no server configured',false);}catch(e){}if(showDebug)console.debug('[App] confirmedCross skipped POST /send-alert because serverUrl is not set');return;}const payload={symbol:symToShow,price:priceToUse,message:type+' @ '+priceToUse,emaShort:monitorEma1,emaLong:monitorEma2};// debug: log state used for send-alert so we can trace mismatched alerts\ntry{console.log('[App] sending /send-alert',{sendSym:symToShow,selectedSymbol:symbol,activeSymbol,confirmedCross,confirmedSource,ema9,ema26,lastPrice,lastTick});}catch(e){}// also show a brief UI toast with the same debug info so it's visible without DevTools\ntry{const dbg=\"\".concat(symToShow,\" \").concat(confirmedCross,\" | active:\").concat(activeSymbol||'—',\" | ema:\").concat(typeof ema9==='number'?ema9.toFixed(4):'—',\"/\").concat(typeof ema26==='number'?ema26.toFixed(4):'—',\" | price:\").concat(typeof lastPrice!=='undefined'&&lastPrice!==null?lastPrice:'—');try{showToast(\"[DEBUG] \".concat(dbg),true);}catch(e){console.log('[App] showToast debug failed',e);}}catch(e){}const maxAttempts=3;let attempt=0;let lastError=null;while(attempt<maxAttempts){attempt+=1;try{if(showDebug)console.debug('[App] confirmedCross sending /send-alert attempt',attempt,payload);const res=await fetch(\"\".concat(serverUrl,\"/send-alert\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});let json=null;try{json=await res.json();}catch(e){json=null;}const sendEv={ts:Date.now(),time:new Date().toLocaleString(),type:'telegram_send',symbol:symToShow,source:'client-confirmed',ok:res.ok,status:res.status,body:json,attempt};try{addEvent(sendEv);}catch(e){setEvents(prev=>[sendEv,...prev].slice(0,500));}try{showToast(res.ok?\"Telegram send OK (\".concat(symToShow,\")\"):\"Telegram send failed (\".concat(res.status,\")\"),res.ok);}catch(e){}if(res.ok)break;// success\nlastError=new Error(\"HTTP \".concat(res.status));}catch(e){lastError=e;if(showDebug)console.debug('[App] confirmedCross send attempt failed',attempt,e);}// exponential backoff before retrying\nif(attempt<maxAttempts){const delay=500*Math.pow(2,attempt-1);// 500ms, 1000ms\nawait new Promise(r=>setTimeout(r,delay));}}if(lastError&&showDebug)console.debug('[App] confirmedCross final send error',lastError);})();// browser notification\nif('Notification'in window&&Notification.permission==='granted'){new Notification(type,{body});}// beep and log\nbeep();const evObj={ts:Date.now(),time:new Date().toLocaleString(),type:confirmedCross,price:lastPrice,symbol:symToShow,source:confirmedSource||'unknown'};if(showDebug)console.debug('[App] created confirmedCross event',evObj);setEvents(s=>[evObj,...s].slice(0,500));lastNotified.current=confirmedCross;}},[confirmedCross,lastPrice,lastTick,symbol,activeSymbol,confirmedSource,showDebug,addEvent,showToast,ema9,ema26,serverUrl,monitorEma1,monitorEma2]);// 심볼이 바뀔 때 이전 심볼의 알림 상태가 남아 있어 잘못된 알림이 뜨는 문제 방지\n// 심볼을 변경하면 lastNotified를 초기화해서 다음 confirmedCross는 초기 시드로 처리되도록 한다.\nuseEffect(()=>{try{lastNotified.current=null;}catch(e){}// also clear displayed events when symbol changes to avoid mixing alerts from different symbols\ntry{setEvents([]);}catch(e){}},[symbol]);// persist last selected symbol so the app remembers it between sessions\nuseEffect(()=>{try{if(!symbol)return;const norm=(symbol||'').toString().replace(/[^A-Za-z0-9]/g,'').toUpperCase();localStorage.setItem('lastSymbol',norm);}catch(e){}},[symbol]);// theme (darkMode) persisted in localStorage\nconst[darkMode,setDarkMode]=useState(()=>{try{return localStorage.getItem('darkMode')==='1';}catch(e){return false;}});const toggleDark=React.useCallback(()=>{try{setDarkMode(d=>{const next=!d;try{localStorage.setItem('darkMode',next?'1':'0');}catch(e){};return next;});}catch(e){}},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App \".concat(darkMode?'dark':''),children:[/*#__PURE__*/_jsx(TopMenu,{onNavigate:setView,view:view,darkMode:darkMode,toggleDark:toggleDark,serverSymbol:serverSymbol,sseConnected:sseConnected,lastHealthyAt:lastHealthyAt,telegramConfigured:telegramConfigured}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card \".concat(view==='alerts'?'view-alerts':''),children:view==='scanner'?/*#__PURE__*/_jsx(ScannerPage,{availableSymbols:availableSymbols,fetchExchangeInfo:fetchExchangeInfo,monitorMinutes:monitorMinutes,setMonitorMinutes:setMonitorMinutes,monitorEma1:monitorEma1,setMonitorEma1:setMonitorEma1,monitorEma2:monitorEma2,setMonitorEma2:setMonitorEma2}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),toast&&/*#__PURE__*/_jsxs(\"div\",{className:\"toast \".concat(toast.ok?'toast-ok':'toast-err'),role:\"status\",\"aria-live\":\"polite\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"toast-title\",children:toast.ok?'Success':'Error'}),/*#__PURE__*/_jsx(\"div\",{className:\"toast-body\",children:toast.message})]}),/*#__PURE__*/_jsx(Controls,{symbol:symbol,setSymbol:setSymbol,symbolValid:symbolValid,setSymbolValid:setSymbolValid,suggestions:suggestions,setSuggestions:setSuggestions,availableSymbols:availableSymbols,validateSymbolOnce:validateSymbolOnce,connect:setServerAndConnect,disconnect:disconnect,status:status,connected:connected// monitoring inputs\n,monitorMinutes:monitorMinutes,setMonitorMinutes:setMonitorMinutes,monitorEma1:monitorEma1,setMonitorEma1:setMonitorEma1,monitorEma2:monitorEma2,setMonitorEma2:setMonitorEma2}),status==='reloading'&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-text\",children:\"\\uCD08\\uAE30\\uD654 \\uC911... \\uC7A0\\uC2DC\\uB9CC \\uAE30\\uB2E4\\uB824\\uC8FC\\uC138\\uC694\"}),symbolValid===false&&/*#__PURE__*/_jsxs(\"div\",{className:\"invalid-msg\",children:[\"Invalid symbol \\u2014 please check the trading pair (e.g. BTCUSDT)\",suggestions&&suggestions.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"suggestions-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"suggestions-title\",children:\"Did you mean:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"suggestions-list\",children:suggestions.map(s=>/*#__PURE__*/_jsx(\"button\",{className:\"suggestion-btn\",onClick:()=>{setSymbol(s);setSymbolValid(true);setSuggestions([]);try{if(autoStart)setServerAndConnect(s);}catch(e){}},children:s},s))})]})]}),view==='debug'?/*#__PURE__*/_jsx(DebugPanel,{availableSymbols:availableSymbols,fetchExchangeInfo:fetchExchangeInfo,showDebug:showDebug,setMarketCheckResult:setMarketCheckResult,marketCheckResult:marketCheckResult,symbol:symbol,onSimulateAlert:simulateConfirmedCross}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"status\",children:[\"Status: \",/*#__PURE__*/_jsx(\"strong\",{children:status}),\" \",connected?/*#__PURE__*/_jsx(\"span\",{className:\"status-connected\",children:\"(connected)\"}):/*#__PURE__*/_jsx(\"span\",{className:\"status-disconnected\",children:\"(disconnected)\"})]}),/*#__PURE__*/_jsx(Metrics,{activeSymbol:activeSymbol,symbol:symbol,lastPrice:lastPrice,lastTick:lastTick,lastCandleClosed:lastCandleClosed,cross:cross,confirmedCross:confirmedCross,ema9:ema9,ema26:ema26,monitorEma1:monitorEma1,monitorEma2:monitorEma2}),/*#__PURE__*/_jsx(Alerts,{events:events,removeAlertByTs:removeAlertByTs,symbol:symbol,symbolValid:symbolValid,status:status,connect:setServerAndConnect,disconnect:disconnect,monitorMinutes:monitorMinutes,monitorEma1:monitorEma1,monitorEma2:monitorEma2,monitorConfirm:monitorConfirm}),/*#__PURE__*/_jsx(Notes,{children:\"Notes: This app uses Binance public REST + websocket. Make sure network allows wss access to stream.binance.com.\"})]})})})]});}export default App;","map":{"version":3,"names":["React","useEffect","useRef","useState","useEmaCross","Alerts","Metrics","Controls","DebugPanel","Notes","Header","TopMenu","ScannerPage","scannerManager","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","beep","AudioCtx","window","AudioContext","webkitAudioContext","ctx","o","createOscillator","g","createGain","type","frequency","value","connect","destination","start","gain","setValueAtTime","currentTime","exponentialRampToValueAtTime","setTimeout","stop","close","e","App","symbol","setSymbol","raw","localStorage","getItem","toString","replace","toUpperCase","autoStart","setAutoStart","symbolValid","setSymbolValid","availableSymbols","setAvailableSymbols","showDebug","suggestions","setSuggestions","monitorMinutes","setMonitorMinutes","parsed","JSON","parse","Number","monitorEma1","setMonitorEma1","monitorEma2","setMonitorEma2","monitorConfirm","marketCheckResult","setMarketCheckResult","fetchExchangeInfo","res","fetch","ok","console","warn","status","data","json","syms","symbols","map","s","validateSymbolOnce","q","length","normQ","sym","normSym","concat","Array","isArray","ema9","ema26","lastPrice","lastTick","lastCandleClosed","cross","confirmedCross","confirmedSource","connected","disconnect","activeSymbol","autoConnect","debug","interval","emaShort","emaLong","confirmClosedCandles","events","setEvents","toast","setToast","isDuplicateEvent","useCallback","newEv","existing","aSym","bSym","price","String","aTs","ts","Date","time","bTs","Math","abs","addEvent","ev","prev","some","p","slice","setGetSymbols","showToast","message","arguments","undefined","now","lastNotified","sseConnected","setSseConnected","serverSymbol","setServerSymbol","lastHealthyAt","setLastHealthyAt","telegramConfigured","setTelegramConfigured","view","setView","_rawServerUrl","process","env","REACT_APP_SERVER_URL","serverUrl","trimmed","trim","location","origin","simulateConfirmedCross","forceType","text","toLocaleString","source","url","payload","method","headers","body","stringify","sendEv","errEv","error","err","EventSource","es","onopen","then","r","j","catch","onmessage","obj","current","incoming","evObj","when","alert","onerror","setServerAndConnect","opts","test","confirmCandles","paramsObj","params","URLSearchParams","toStore","endsWith","lastSymbol","setItem","mounted","poll","id","setInterval","clearInterval","ALERTS_LS_KEY","saveAlertsToLocalStorage","arr","loadAlertsFromLocalStorage","saved","cutoff","normTarget","filtered","filter","isNaN","evSym","removeAlertByTs","next","handle","Notification","permission","requestPermission","removeEventListener","addEventListener","symToShowRaw","symToShow","priceToUse","log","sendSym","selectedSymbol","dbg","toFixed","maxAttempts","attempt","lastError","Error","delay","pow","Promise","norm","darkMode","setDarkMode","toggleDark","d","className","children","onNavigate","role","onClick","onSimulateAlert"],"sources":["C:/Users/e1it3/Desktop/program/binance_alert/src/App.js"],"sourcesContent":["import './App.css';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport useEmaCross from './hooks/useEmaCross';\r\nimport Alerts from './components/Alerts';\r\nimport Metrics from './components/Metrics';\r\nimport Controls from './components/Controls';\r\nimport DebugPanel from './components/DebugPanel';\r\nimport Notes from './components/Notes';\r\nimport Header from './components/Header';\r\nimport TopMenu from './components/TopMenu';\r\nimport ScannerPage from './pages/ScannerPage';\r\nimport scannerManager from './lib/scannerManager';\r\n\r\nfunction beep() {\r\n  try {\r\n    const AudioCtx = window.AudioContext || window.webkitAudioContext;\r\n    const ctx = new AudioCtx();\r\n    const o = ctx.createOscillator();\r\n    const g = ctx.createGain();\r\n    o.type = 'sine';\r\n    o.frequency.value = 880;\r\n    o.connect(g);\r\n    g.connect(ctx.destination);\r\n    o.start();\r\n    g.gain.setValueAtTime(0.0001, ctx.currentTime);\r\n    g.gain.exponentialRampToValueAtTime(0.1, ctx.currentTime + 0.01);\r\n    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.6);\r\n    setTimeout(() => {\r\n      o.stop();\r\n      try { ctx.close(); } catch (e) {}\r\n    }, 700);\r\n  } catch (e) {\r\n    // ignore\r\n  }\r\n}\r\n\r\nfunction App() {\r\n  const [symbol, setSymbol] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem('lastSymbol');\r\n      if (raw && typeof raw === 'string') return raw.toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n    } catch (e) {}\r\n    return 'BTCUSDT';\r\n  });\r\n  const [autoStart, setAutoStart] = useState(true);\r\n  const [symbolValid, setSymbolValid] = useState(null); // null=unknown, true/false\r\n  // symbolValidateTimer moved into Controls component\r\n  const [availableSymbols, setAvailableSymbols] = useState(null);\r\n  const [showDebug] = useState(false);\r\n  const [suggestions, setSuggestions] = useState([]);\r\n  // monitoring inputs (minutes + EMA short/long)\r\n  const [monitorMinutes, setMonitorMinutes] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem('lastMonitor');\r\n      if (raw) {\r\n        const parsed = JSON.parse(raw);\r\n        if (parsed && typeof parsed.monitorMinutes !== 'undefined') return Number(parsed.monitorMinutes) || 5;\r\n      }\r\n    } catch (e) {}\r\n    return 5;\r\n  });\r\n  const [monitorEma1, setMonitorEma1] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem('lastMonitor');\r\n      if (raw) {\r\n        const parsed = JSON.parse(raw);\r\n        if (parsed && typeof parsed.monitorEma1 !== 'undefined') return Number(parsed.monitorEma1) || 26;\r\n      }\r\n    } catch (e) {}\r\n    return 26;\r\n  });\r\n  const [monitorEma2, setMonitorEma2] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem('lastMonitor');\r\n      if (raw) {\r\n        const parsed = JSON.parse(raw);\r\n        if (parsed && typeof parsed.monitorEma2 !== 'undefined') return Number(parsed.monitorEma2) || 200;\r\n      }\r\n    } catch (e) {}\r\n    return 200;\r\n  });\r\n  const [monitorConfirm] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem('lastMonitor');\r\n      if (raw) {\r\n        const parsed = JSON.parse(raw);\r\n        if (parsed && typeof parsed.monitorConfirm !== 'undefined') return Number(parsed.monitorConfirm) || 1;\r\n      }\r\n    } catch (e) {}\r\n    // increase default confirmation to 2 closed candles to reduce false positives\r\n    return 2;\r\n  });\r\n  const [marketCheckResult, setMarketCheckResult] = useState(null);\r\n  // helper to fetch exchangeInfo and populate availableSymbols\r\n  async function fetchExchangeInfo() {\r\n    try {\r\n      // default to Binance Futures (USDT-M) exchangeInfo for symbols\r\n      const res = await fetch('https://fapi.binance.com/fapi/v1/exchangeInfo');\r\n      if (!res.ok) {\r\n        console.warn('exchangeInfo fetch failed', res.status);\r\n        setAvailableSymbols([]);\r\n        return;\r\n      }\r\n      const data = await res.json();\r\n      const syms = (data.symbols || []).map(s => s.symbol);\r\n      setAvailableSymbols(syms);\r\n    } catch (e) {\r\n      console.warn('exchangeInfo fetch error', e);\r\n      setAvailableSymbols([]);\r\n    }\r\n  }\r\n\r\n  // fetch full symbol list once on mount for reliable validation\r\n  // fetch full symbol list once on mount for reliable validation\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  useEffect(() => {\r\n    fetchExchangeInfo();\r\n  }, []);\r\n\r\n\r\n\r\n  // helper to validate a symbol (returns true/false)\r\n  async function validateSymbolOnce(s) {\r\n    const q = (s || '').replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n    if (!q) return false;\r\n    // If we have a cached symbol list, compare using a normalized form (strip non-alnum, uppercase)\r\n    if (availableSymbols && availableSymbols.length > 0) {\r\n      const normQ = q;\r\n      for (const sym of availableSymbols) {\r\n        const normSym = (sym || '').replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n        if (normSym === normQ) return true;\r\n      }\r\n      return false;\r\n    }\r\n    // Fallback to exchangeInfo query for the single symbol\r\n    try {\r\n      // fallback to Binance Futures exchangeInfo lookup\r\n      const res = await fetch(`https://fapi.binance.com/fapi/v1/exchangeInfo?symbol=${q}`);\r\n      if (!res.ok) return false;\r\n      const data = await res.json();\r\n      // if API returned an object with matching symbol(s), accept it\r\n      if (data && Array.isArray(data.symbols) && data.symbols.length > 0) return true;\r\n      if (data && data.symbol) return true;\r\n      return false;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // if symbol becomes invalid, disable autoStart and disconnect to avoid wrong subscriptions\r\n  // (moved below after hook initialization because it depends on connected/disconnect)\r\n  // Disable hook autoConnect: App will control connecting so we can update server monitor symbol first\r\n  const { ema9, ema26, lastPrice, lastTick, lastCandleClosed, cross, confirmedCross, confirmedSource, connected, status, connect, disconnect, activeSymbol } = useEmaCross({ symbol, autoConnect: true, debug: showDebug, interval: `${monitorMinutes}m`, emaShort: monitorEma1, emaLong: monitorEma2, confirmClosedCandles: monitorConfirm });\r\n\r\n  \r\n  \r\n  const [events, setEvents] = useState([]);\r\n  const [toast, setToast] = useState(null);\r\n  // Helper: detect duplicate events and add only if not duplicate\r\n  // Dedup logic: consider events duplicate if symbol + type match and their timestamps are within 5s,\r\n  // or if price matches exactly and symbol+type match. This helps avoid server+client duplicate alerts.\r\n  const isDuplicateEvent = React.useCallback((newEv, existing) => {\r\n    try {\r\n      if (!existing || !newEv) return false;\r\n      const aSym = (existing.symbol || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n      const bSym = (newEv.symbol || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n      if (!aSym || !bSym || aSym !== bSym) return false;\r\n      if ((existing.type || '') !== (newEv.type || '')) return false;\r\n      // exact price match\r\n      if (typeof existing.price !== 'undefined' && typeof newEv.price !== 'undefined' && String(existing.price) === String(newEv.price)) return true;\r\n      // timestamp proximity (use ts if available, otherwise parse time)\r\n      const aTs = typeof existing.ts === 'number' ? existing.ts : (Date.parse(existing.time || '') || 0);\r\n      const bTs = typeof newEv.ts === 'number' ? newEv.ts : (Date.parse(newEv.time || '') || 0);\r\n      if (aTs && bTs && Math.abs(aTs - bTs) <= 5000) return true;\r\n    } catch (e) {}\r\n    return false;\r\n  }, []);\r\n\r\n  const addEvent = React.useCallback((ev) => {\r\n    setEvents((prev) => {\r\n      try {\r\n        if (Array.isArray(prev) && prev.some((p) => isDuplicateEvent(ev, p))) {\r\n          if (showDebug) console.debug('[App] suppressed duplicate event', ev);\r\n          return prev;\r\n        }\r\n      } catch (e) {}\r\n      return [ev, ...prev].slice(0, 500);\r\n    });\r\n  }, [isDuplicateEvent, showDebug]);\r\n  // Inform scannerManager about available symbols.\r\n  // IMPORTANT: do NOT forward raw scanner \"results\" into the global Alerts/events list here.\r\n  // Scanner results are shown on the separate Scanner page and should not be mixed with Alerts.\r\n  useEffect(() => {\r\n    try {\r\n      scannerManager.setGetSymbols(() => availableSymbols || []);\r\n    } catch (e) {}\r\n  }, [availableSymbols]);\r\n  const showToast = React.useCallback((message, ok = true) => {\r\n    try {\r\n      setToast({ message, ok, ts: Date.now() });\r\n      // auto-dismiss after 5s\r\n      setTimeout(() => {\r\n        try { setToast(null); } catch (e) {}\r\n      }, 5000);\r\n    } catch (e) {}\r\n  }, []);\r\n  const lastNotified = useRef(null);\r\n  const [sseConnected, setSseConnected] = useState(false);\r\n  const [serverSymbol, setServerSymbol] = useState(null);\r\n  const [lastHealthyAt, setLastHealthyAt] = useState(null);\r\n  const [telegramConfigured, setTelegramConfigured] = useState(null); // null=unknown, true/false\r\n  const [view, setView] = useState('alerts');\r\n  // serverUrl is provided at build-time via REACT_APP_SERVER_URL; when not set\r\n  // the app should run in \"client-only\" mode (no SSE, no server Telegram relay).\r\n  // Trim the env var to avoid accidental trailing-space issues embedding a bad URL\r\n  const _rawServerUrl = (process.env.REACT_APP_SERVER_URL && typeof process.env.REACT_APP_SERVER_URL === 'string') ? process.env.REACT_APP_SERVER_URL : '';\r\n  // Default to same-origin when env var isn't provided so a single Render service works out of the box\r\n  const serverUrl = (() => {\r\n    const trimmed = (_rawServerUrl || '').trim();\r\n    if (trimmed.length > 0) return trimmed;\r\n    try {\r\n      if (typeof window !== 'undefined' && window.location && window.location.origin) {\r\n        return window.location.origin;\r\n      }\r\n    } catch (e) {}\r\n    return null;\r\n  })();\r\n\r\n  // Debug helper: simulate a confirmed cross from the frontend (calls /send-alert and adds local event)\r\n  const simulateConfirmedCross = React.useCallback((forceType) => {\r\n    try {\r\n      const type = forceType || (confirmedCross || 'bull');\r\n      const sym = (activeSymbol || symbol || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n      const price = lastPrice || 0;\r\n  // Use configured EMA labels (monitorEma1/monitorEma2) in the message text\r\n  const text = `${sym} ${type === 'bull' ? `Bullish EMA${monitorEma1} > EMA${monitorEma2}` : `Bearish EMA${monitorEma1} < EMA${monitorEma2}`} @ ${price}`;\r\n      // add local event\r\n      const ev = { ts: Date.now(), time: new Date().toLocaleString(), type: type === 'bull' ? 'bull' : 'bear', price, symbol: sym, source: 'client-sim' };\r\n      addEvent(ev);\r\n      // fire server send\r\n      (async () => {\r\n        if (!serverUrl) {\r\n          // no server configured (static mode): inform user that Telegram relay is disabled\r\n          try { showToast('Telegram disabled: no server configured', false); } catch (e) {}\r\n          if (showDebug) console.debug('[App] simulateConfirmedCross skipped POST /send-alert because serverUrl is not set');\r\n          return;\r\n        }\r\n        try {\r\n          if (showDebug) console.debug('[App] simulate sending /send-alert', { url: `${serverUrl}/send-alert`, payload: { symbol: sym, price, message: text, emaShort: monitorEma1, emaLong: monitorEma2 } });\r\n          const res = await fetch(`${serverUrl}/send-alert`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ symbol: sym, price, message: text, emaShort: monitorEma1, emaLong: monitorEma2 }) });\r\n          let json = null;\r\n          try { json = await res.json(); } catch (e) { json = null; }\r\n          const sendEv = { ts: Date.now(), time: new Date().toLocaleString(), type: 'telegram_send', symbol: sym, source: 'client-send', ok: res.ok, status: res.status, body: json };\r\n          addEvent(sendEv);\r\n          // show immediate toast to user\r\n          try { showToast(res.ok ? `Telegram send OK (${sym})` : `Telegram send failed (${res.status})`, res.ok); } catch (e) {}\r\n          if (showDebug) console.debug('[App] simulate /send-alert response', sendEv);\r\n        } catch (e) {\r\n          const errEv = { ts: Date.now(), time: new Date().toLocaleString(), type: 'telegram_send', symbol: sym, source: 'client-send', ok: false, error: String(e) };\r\n          addEvent(errEv);\r\n          try { showToast(`Telegram send error: ${String(e)}`, false); } catch (err) {}\r\n          if (showDebug) console.debug('[App] simulate send-alert failed', e);\r\n        }\r\n      })();\r\n    } catch (e) { if (showDebug) console.debug('[App] simulateConfirmedCross error', e); }\r\n  }, [activeSymbol, symbol, lastPrice, addEvent, showDebug, confirmedCross, showToast, serverUrl, monitorEma1, monitorEma2]);\r\n\r\n \r\n\r\n  // Subscribe to server-sent events from server (realtime alerts emitted by server)\r\n  useEffect(() => {\r\n    // If no server URL is configured (static/client-only), skip creating SSE\r\n    if (!serverUrl) {\r\n      setSseConnected(false);\r\n      return undefined;\r\n    }\r\n    if (!window.EventSource) return undefined;\r\n    let es;\r\n    try {\r\n      es = new EventSource(`${serverUrl}/events`);\r\n      es.onopen = () => {\r\n        setSseConnected(true);\r\n        // fetch health once when SSE opens to sync server-side monitored symbol\r\n        try {\r\n          fetch(`${serverUrl}/health`).then((r) => r.json()).then((j) => { if (j && j.symbol) setServerSymbol((j.symbol || '').toString().toUpperCase()); }).catch(() => {});\r\n        } catch (e) {}\r\n      };\r\n      es.onmessage = (e) => {\r\n        try {\r\n          const obj = JSON.parse(e.data);\r\n          if (!obj) return;\r\n          // handle server alert events and telegram_sent confirmations\r\n          if (obj.type === 'alert') {\r\n            // prefer the activeSymbol from the hook, fallback to the selected symbol\r\n            const current = (activeSymbol || symbol || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n            const incoming = (obj.symbol || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n            // require incoming symbol to be present and match the currently-active symbol\r\n            if (!incoming || !current || incoming !== current) {\r\n              if (showDebug) console.debug('[App] dropping SSE alert for different symbol', { incoming, current, obj });\r\n              return;\r\n            }\r\n\r\n            const evObj = { ts: obj.ts || Date.now(), time: obj.when ? new Date(obj.when).toLocaleString() : new Date().toLocaleString(), type: obj.alert === 'bull' ? 'bull' : 'bear', price: obj.price, symbol: incoming, source: 'server' };\r\n            // use centralized dedupe/add helper\r\n            try { addEvent(evObj); } catch (e) { setEvents((prev) => [evObj, ...prev].slice(0, 500)); }\r\n          } else if (obj.type === 'telegram_sent') {\r\n            // server confirmed it sent a telegram; add a small event so UI reflects it\r\n            try {\r\n              const sym = (obj.symbol || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase() || (activeSymbol || symbol || '').toString().toUpperCase();\r\n              const ev = { ts: obj.ts || Date.now(), time: new Date(obj.ts || Date.now()).toLocaleString(), type: 'telegram', price: obj.price || lastPrice, symbol: sym, source: 'server-telegram', ok: obj.ok };\r\n              addEvent(ev);\r\n            } catch (e) {}\r\n          }\r\n        } catch (err) {}\r\n      };\r\n      es.onerror = () => {\r\n        setSseConnected(false);\r\n        try { es.close(); } catch (e) {}\r\n      };\r\n    } catch (e) {}\r\n    return () => { try { es && es.close(); } catch (e) {} };\r\n  }, [symbol, activeSymbol, showDebug, addEvent, lastPrice, serverUrl]);\r\n\r\n  // helper to ask server to monitor a symbol, then connect the client\r\n  const setServerAndConnect = React.useCallback(async (sym, opts) => {\r\n    const q = (sym || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n  let interval = (opts && typeof opts.interval !== 'undefined') ? opts.interval : monitorMinutes;\r\n    // normalize interval to a string accepted by Binance (e.g., '5m'). If a plain number is provided, treat as minutes.\r\n    if (typeof interval === 'number' || (typeof interval === 'string' && /^\\d+$/.test(String(interval)))) {\r\n      interval = `${interval}m`;\r\n    }\r\n  const emaShort = (opts && typeof opts.emaShort !== 'undefined') ? opts.emaShort : monitorEma1;\r\n  const emaLong = (opts && typeof opts.emaLong !== 'undefined') ? opts.emaLong : monitorEma2;\r\n  const confirmCandles = (opts && typeof opts.confirmCandles !== 'undefined') ? opts.confirmCandles : monitorConfirm;\r\n    if (!q) {\r\n      try { connect(sym); } catch (e) {}\r\n      return;\r\n    }\r\n    try {\r\n      // update UI optimistically so the menu reflects the user's requested symbol\r\n      // even if the server is temporarily unreachable. Then notify the server.\r\n      setServerSymbol(q);\r\n      // call server endpoint to change monitored symbol and monitoring params\r\n      const paramsObj = { symbol: q, interval: String(interval), emaShort: String(emaShort), emaLong: String(emaLong) };\r\n      if (typeof confirmCandles !== 'undefined' && confirmCandles !== null) paramsObj.confirmCandles = String(confirmCandles);\r\n      const params = new URLSearchParams(paramsObj);\r\n      try {\r\n        await fetch(`${serverUrl}/set-symbol?${params.toString()}`, { method: 'GET' });\r\n      } catch (err) {\r\n        // server may be down; keep the optimistic UI state but inform user\r\n        try { showToast(`Server set-symbol failed: ${String(err)}`, false); } catch (e) {}\r\n        if (showDebug) console.debug('[App] /set-symbol request failed', err);\r\n      }\r\n    } catch (e) {\r\n      // ignore server errors and proceed to connect locally\r\n    }\r\n    try { connect(q); } catch (e) {}\r\n    // persist the last-used monitor inputs so Alerts/Controls can restore them\r\n    try {\r\n      const toStore = { monitorMinutes: (typeof interval === 'string' && interval.endsWith('m')) ? Number(interval.replace(/m$/, '')) : Number(interval), monitorEma1: Number(emaShort), monitorEma2: Number(emaLong), lastSymbol: q };\r\n      localStorage.setItem('lastMonitor', JSON.stringify(toStore));\r\n    } catch (e) {}\r\n  }, [connect, monitorMinutes, monitorEma1, monitorEma2, monitorConfirm, showDebug, showToast, serverUrl]);\r\n\r\n  \r\n\r\n  // 자동 연결: symbol이 유효하고 autoStart가 켜져 있으면 Start 버튼을 누르지 않아도 connect 호출\r\n  useEffect(() => {\r\n    try {\r\n      const q = (symbol || '').replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n      // only attempt auto-start after the hook has initialized its EMA seed\r\n      if (q && symbolValid === true && autoStart && status === 'initialized') {\r\n        if (!activeSymbol || activeSymbol.toString().toUpperCase() !== q) {\r\n          // ensure server monitor symbol is updated before connecting\r\n          try { setServerAndConnect(q); } catch (e) { connect(q); }\r\n        }\r\n      }\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }, [symbol, symbolValid, autoStart, activeSymbol, connect, setServerAndConnect, status]);\r\n\r\n  // fetch server health on mount in case SSE isn't available yet\r\n  useEffect(() => {\r\n    if (!serverUrl) {\r\n      // no server configured (static mode)\r\n      setTelegramConfigured(false);\r\n      return;\r\n    }\r\n    try {\r\n      fetch(`${serverUrl}/health`).then((r) => r.json()).then((j) => { if (j && j.symbol) setServerSymbol((j.symbol || '').toString().toUpperCase()); if (j) { setLastHealthyAt(Date.now()); if (typeof j?.telegramConfigured !== 'undefined') setTelegramConfigured(!!j.telegramConfigured); } }).catch(() => {});\r\n    } catch (e) {}\r\n  }, [serverUrl]);\r\n\r\n  // poll /health periodically so UI can show last healthy time; keeps serverSymbol and telegramConfigured in sync\r\n  useEffect(() => {\r\n    if (!serverUrl) return undefined;\r\n    let mounted = true;\r\n    async function poll() {\r\n      try {\r\n        const r = await fetch(`${serverUrl}/health`);\r\n        if (!mounted) return;\r\n        const j = await r.json();\r\n        if (j && j.symbol) setServerSymbol((j.symbol || '').toString().toUpperCase());\r\n        if (j) {\r\n          setLastHealthyAt(Date.now());\r\n          if (typeof j?.telegramConfigured !== 'undefined') setTelegramConfigured(!!j.telegramConfigured);\r\n        }\r\n      } catch (e) {\r\n        // keep lastHealthyAt as-is on error\r\n      }\r\n    }\r\n    // initial poll\r\n    poll();\r\n    const id = setInterval(poll, 15000);\r\n    return () => { mounted = false; clearInterval(id); };\r\n  }, [serverUrl]);\r\n\r\n  // clearAlerts will be handled inline if needed; no export/import UI\r\n\r\n  // --- localStorage에 Alerts 저장/복원 헬퍼 ---\r\n  const ALERTS_LS_KEY = 'alerts';\r\n  function saveAlertsToLocalStorage(arr) {\r\n    try {\r\n      if (!Array.isArray(arr)) return;\r\n      // 저장 크기 제한을 위해 최신 500개(로컬스토리지라 쿠키보다 여유)\r\n      const toStore = JSON.stringify(arr.slice(0, 500));\r\n      localStorage.setItem(ALERTS_LS_KEY, toStore);\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }\r\n\r\n  function loadAlertsFromLocalStorage() {\r\n    try {\r\n      const raw = localStorage.getItem(ALERTS_LS_KEY);\r\n      if (!raw) return null;\r\n      const parsed = JSON.parse(raw);\r\n      if (Array.isArray(parsed)) return parsed;\r\n      return null;\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // 복원: 마운트 시 localStorage에서 alerts 복원 (7일 초과 항목은 제거)\r\n  useEffect(() => {\r\n    try {\r\n      const saved = loadAlertsFromLocalStorage();\r\n      if (saved && Array.isArray(saved) && saved.length > 0) {\r\n        const cutoff = Date.now() - 1000 * 60 * 60 * 24 * 7; // 7 days\r\n        const normTarget = (symbol || '').replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n        const filtered = saved.filter((ev) => {\r\n          if (!ev) return false;\r\n          if (typeof ev.ts === 'number' && ev.ts < cutoff) return false;\r\n          // try parse time string as fallback\r\n          if (typeof ev.ts !== 'number') {\r\n            const parsed = Date.parse(ev.time || '');\r\n            if (isNaN(parsed) || parsed < cutoff) return false;\r\n          }\r\n          // require event symbol to match the current selected symbol to avoid showing other-pair alerts\r\n          const evSym = (ev.symbol || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n          return evSym === normTarget;\r\n        });\r\n        setEvents(filtered);\r\n      }\r\n    } catch (e) {}\r\n  }, [symbol]);\r\n\r\n  // Persist monitor inputs whenever they change so UI values are remembered\r\n  useEffect(() => {\r\n    try {\r\n      const toStore = { monitorMinutes, monitorEma1, monitorEma2, monitorConfirm, lastSymbol: symbol };\r\n      localStorage.setItem('lastMonitor', JSON.stringify(toStore));\r\n    } catch (e) {}\r\n  }, [monitorMinutes, monitorEma1, monitorEma2, monitorConfirm, symbol]);\r\n\r\n  // 저장: events가 바뀔 때마다 localStorage에 반영 (저장 전에 7일 초과 항목 제거)\r\n  useEffect(() => {\r\n    try {\r\n      const cutoff = Date.now() - 1000 * 60 * 60 * 24 * 7; // 7 days\r\n      const filtered = (events || []).filter((ev) => {\r\n        if (!ev) return false;\r\n        if (typeof ev.ts === 'number') return ev.ts >= cutoff;\r\n        const parsed = Date.parse(ev.time || '');\r\n        if (!isNaN(parsed)) return parsed >= cutoff;\r\n        return false;\r\n      });\r\n      saveAlertsToLocalStorage(filtered);\r\n    } catch (e) {}\r\n  }, [events]);\r\n\r\n  // Alerts 항목 삭제 핸들러 (ts 기반으로 고유 항목 제거)\r\n  function removeAlertByTs(ts) {\r\n    try {\r\n      const next = (events || []).filter((ev) => ev && ev.ts !== ts);\r\n      setEvents(next);\r\n    } catch (e) {}\r\n  }\r\n  \r\n\r\n  // if symbol becomes invalid, disable autoStart and disconnect to avoid wrong subscriptions\r\n  useEffect(() => {\r\n    if (symbolValid === false) {\r\n      if (autoStart) setAutoStart(false);\r\n      // ensure disconnected\r\n      if (connected) disconnect();\r\n    }\r\n    // include dependencies to avoid stale closures\r\n  }, [symbolValid, autoStart, connected, disconnect]);\r\n\r\n  // Ask for notification permission on first user interaction\r\n  useEffect(() => {\r\n    const handle = () => {\r\n      if ('Notification' in window && Notification.permission === 'default') {\r\n        Notification.requestPermission().then(() => {});\r\n      }\r\n      window.removeEventListener('click', handle);\r\n    };\r\n    window.addEventListener('click', handle);\r\n    return () => window.removeEventListener('click', handle);\r\n  }, []);\r\n\r\n  // react to confirmed cross changes and notify (skip initial)\r\n  useEffect(() => {\r\n  if (!confirmedCross) return;\r\n    // If the confirmed signal came from initial seeding, don't notify — treat as seeded state\r\n    if (confirmedSource === 'init') {\r\n      // ensure we don't trigger notification for seed values\r\n      lastNotified.current = confirmedCross;\r\n      return;\r\n    }\r\n    if (lastNotified.current == null) {\r\n      // seed without notifying\r\n      lastNotified.current = confirmedCross;\r\n      return;\r\n    }\r\n\r\n    if (lastNotified.current !== confirmedCross) {\r\n  const type = confirmedCross === 'bull' ? `Bullish EMA${monitorEma1} > EMA${monitorEma2}` : `Bearish EMA${monitorEma1} < EMA${monitorEma2}`;\r\n      const symToShowRaw = activeSymbol || symbol || '';\r\n      const symToShow = (symToShowRaw || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n        // Determine the authoritative price to show/send. Prefer closed-candle `lastPrice`,\r\n        // but fall back to the most recent live tick (`lastTick`) when a closed price\r\n        // isn't yet available. Still skip only when this is the initial seeded value.\r\n        const priceToUse = (typeof lastPrice !== 'undefined' && lastPrice !== null) ? lastPrice : ((typeof lastTick !== 'undefined' && lastTick !== null) ? lastTick : null);\r\n        if (confirmedSource === 'init') {\r\n          // do not notify for seed values\r\n          lastNotified.current = confirmedCross;\r\n          return;\r\n        }\r\n        if (priceToUse == null) {\r\n          // If we truly have no price at all, skip but log in debug so user can inspect\r\n          if (showDebug) console.debug('[App] skipping notification: no price available (lastPrice & lastTick are null)', { confirmedCross, confirmedSource, activeSymbol, symbol });\r\n          lastNotified.current = confirmedCross;\r\n          return;\r\n        }\r\n        const body = `${symToShow} ${type} @ ${priceToUse}`;\r\n\r\n      // Also request the server to send a Telegram message for this confirmed cross.\r\n      // In static/client-only mode (no serverUrl) skip server relay and show a toast.\r\n      (async () => {\r\n        if (!serverUrl) {\r\n          try { showToast('Telegram disabled: no server configured', false); } catch (e) {}\r\n          if (showDebug) console.debug('[App] confirmedCross skipped POST /send-alert because serverUrl is not set');\r\n          return;\r\n        }\r\n  const payload = { symbol: symToShow, price: priceToUse, message: type + ' @ ' + priceToUse, emaShort: monitorEma1, emaLong: monitorEma2 };\r\n        // debug: log state used for send-alert so we can trace mismatched alerts\r\n        try {\r\n          console.log('[App] sending /send-alert', { sendSym: symToShow, selectedSymbol: symbol, activeSymbol, confirmedCross, confirmedSource, ema9, ema26, lastPrice, lastTick });\r\n        } catch (e) {}\r\n        // also show a brief UI toast with the same debug info so it's visible without DevTools\r\n        try {\r\n          const dbg = `${symToShow} ${confirmedCross} | active:${activeSymbol || '—'} | ema:${(typeof ema9==='number'?ema9.toFixed(4):'—')}/${(typeof ema26==='number'?ema26.toFixed(4):'—')} | price:${(typeof lastPrice!=='undefined'&&lastPrice!==null)?lastPrice:'—'}`;\r\n          try { showToast(`[DEBUG] ${dbg}`, true); } catch (e) { console.log('[App] showToast debug failed', e); }\r\n        } catch (e) {}\r\n        const maxAttempts = 3;\r\n        let attempt = 0;\r\n        let lastError = null;\r\n        while (attempt < maxAttempts) {\r\n          attempt += 1;\r\n          try {\r\n            if (showDebug) console.debug('[App] confirmedCross sending /send-alert attempt', attempt, payload);\r\n            const res = await fetch(`${serverUrl}/send-alert`, {\r\n              method: 'POST',\r\n              headers: { 'Content-Type': 'application/json' },\r\n              body: JSON.stringify(payload),\r\n            });\r\n            let json = null;\r\n            try { json = await res.json(); } catch (e) { json = null; }\r\n            const sendEv = { ts: Date.now(), time: new Date().toLocaleString(), type: 'telegram_send', symbol: symToShow, source: 'client-confirmed', ok: res.ok, status: res.status, body: json, attempt };\r\n            try { addEvent(sendEv); } catch (e) { setEvents((prev) => [sendEv, ...prev].slice(0, 500)); }\r\n            try { showToast(res.ok ? `Telegram send OK (${symToShow})` : `Telegram send failed (${res.status})`, res.ok); } catch (e) {}\r\n            if (res.ok) break; // success\r\n            lastError = new Error(`HTTP ${res.status}`);\r\n          } catch (e) {\r\n            lastError = e;\r\n            if (showDebug) console.debug('[App] confirmedCross send attempt failed', attempt, e);\r\n          }\r\n          // exponential backoff before retrying\r\n          if (attempt < maxAttempts) {\r\n            const delay = 500 * Math.pow(2, attempt - 1); // 500ms, 1000ms\r\n            await new Promise((r) => setTimeout(r, delay));\r\n          }\r\n        }\r\n        if (lastError && showDebug) console.debug('[App] confirmedCross final send error', lastError);\r\n      })();\r\n\r\n      // browser notification\r\n      if ('Notification' in window && Notification.permission === 'granted') {\r\n        new Notification(type, { body });\r\n      }\r\n\r\n      // beep and log\r\n      beep();\r\n      const evObj = { ts: Date.now(), time: new Date().toLocaleString(), type: confirmedCross, price: lastPrice, symbol: symToShow, source: confirmedSource || 'unknown' };\r\n      if (showDebug) console.debug('[App] created confirmedCross event', evObj);\r\n      setEvents((s) => [evObj, ...s].slice(0, 500));\r\n      lastNotified.current = confirmedCross;\r\n    }\r\n  }, [confirmedCross, lastPrice, lastTick, symbol, activeSymbol, confirmedSource, showDebug, addEvent, showToast, ema9, ema26, serverUrl, monitorEma1, monitorEma2]);\r\n\r\n  // 심볼이 바뀔 때 이전 심볼의 알림 상태가 남아 있어 잘못된 알림이 뜨는 문제 방지\r\n  // 심볼을 변경하면 lastNotified를 초기화해서 다음 confirmedCross는 초기 시드로 처리되도록 한다.\r\n  useEffect(() => {\r\n    try {\r\n      lastNotified.current = null;\r\n    } catch (e) {}\r\n    // also clear displayed events when symbol changes to avoid mixing alerts from different symbols\r\n    try { setEvents([]); } catch (e) {}\r\n  }, [symbol]);\r\n\r\n  // persist last selected symbol so the app remembers it between sessions\r\n  useEffect(() => {\r\n    try {\r\n      if (!symbol) return;\r\n      const norm = (symbol || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n      localStorage.setItem('lastSymbol', norm);\r\n    } catch (e) {}\r\n  }, [symbol]);\r\n\r\n  // theme (darkMode) persisted in localStorage\r\n  const [darkMode, setDarkMode] = useState(() => { try { return localStorage.getItem('darkMode') === '1'; } catch (e) { return false; } });\r\n  const toggleDark = React.useCallback(() => {\r\n    try {\r\n      setDarkMode((d) => { const next = !d; try { localStorage.setItem('darkMode', next ? '1' : '0'); } catch (e) {} ; return next; });\r\n    } catch (e) {}\r\n  }, []);\r\n\r\n  return (\r\n    <div className={`App ${darkMode ? 'dark' : ''}`}>\r\n  <TopMenu onNavigate={setView} view={view} darkMode={darkMode} toggleDark={toggleDark} serverSymbol={serverSymbol} sseConnected={sseConnected} lastHealthyAt={lastHealthyAt} telegramConfigured={telegramConfigured} />\r\n      <div className=\"container\">\r\n  <div className={`card ${view === 'alerts' ? 'view-alerts' : ''}`}>\r\n              {view === 'scanner' ? (\r\n            <ScannerPage availableSymbols={availableSymbols} fetchExchangeInfo={fetchExchangeInfo} monitorMinutes={monitorMinutes} setMonitorMinutes={setMonitorMinutes} monitorEma1={monitorEma1} setMonitorEma1={setMonitorEma1} monitorEma2={monitorEma2} setMonitorEma2={setMonitorEma2} />\r\n          ) : (\r\n            <>\r\n              <Header />\r\n              {/* inline toast for quick feedback */}\r\n              {toast && (\r\n                <div className={`toast ${toast.ok ? 'toast-ok' : 'toast-err'}`} role=\"status\" aria-live=\"polite\">\r\n                  <div className=\"toast-title\">{toast.ok ? 'Success' : 'Error'}</div>\r\n                  <div className=\"toast-body\">{toast.message}</div>\r\n                </div>\r\n              )}\r\n\r\n              <Controls\r\n                symbol={symbol}\r\n                setSymbol={setSymbol}\r\n                \r\n                symbolValid={symbolValid}\r\n                setSymbolValid={setSymbolValid}\r\n                suggestions={suggestions}\r\n                setSuggestions={setSuggestions}\r\n                availableSymbols={availableSymbols}\r\n                validateSymbolOnce={validateSymbolOnce}\r\n                connect={setServerAndConnect}\r\n                disconnect={disconnect}\r\n                status={status}\r\n                connected={connected}\r\n                // monitoring inputs\r\n                monitorMinutes={monitorMinutes}\r\n                setMonitorMinutes={setMonitorMinutes}\r\n                monitorEma1={monitorEma1}\r\n                setMonitorEma1={setMonitorEma1}\r\n                monitorEma2={monitorEma2}\r\n                setMonitorEma2={setMonitorEma2}\r\n                \r\n              />\r\n              {/* 간단한 로딩 표시: 심볼 변경으로 상태가 reloading일 때 보임 */}\r\n              {status === 'reloading' && (\r\n                <div className=\"loading-text\">초기화 중... 잠시만 기다려주세요</div>\r\n              )}\r\n              {symbolValid === false && (\r\n                <div className=\"invalid-msg\">\r\n                  Invalid symbol — please check the trading pair (e.g. BTCUSDT)\r\n                  {suggestions && suggestions.length > 0 && (\r\n                    <div className=\"suggestions-wrap\">\r\n                      <div className=\"suggestions-title\">Did you mean:</div>\r\n                      <div className=\"suggestions-list\">\r\n                        {suggestions.map((s) => (\r\n                          <button key={s} className=\"suggestion-btn\" onClick={() => {\r\n                            setSymbol(s);\r\n                            setSymbolValid(true);\r\n                            setSuggestions([]);\r\n                            try { if (autoStart) setServerAndConnect(s); } catch (e) {}\r\n                          }}>{s}</button>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {view === 'debug' ? (\r\n                <DebugPanel availableSymbols={availableSymbols} fetchExchangeInfo={fetchExchangeInfo} showDebug={showDebug} setMarketCheckResult={setMarketCheckResult} marketCheckResult={marketCheckResult} symbol={symbol} onSimulateAlert={simulateConfirmedCross} />\r\n              ) : null}\r\n\r\n              <div className=\"status\">\r\n                Status: <strong>{status}</strong> {connected ? <span className=\"status-connected\">(connected)</span> : <span className=\"status-disconnected\">(disconnected)</span>}\r\n              </div>\r\n\r\n              <Metrics activeSymbol={activeSymbol} symbol={symbol} lastPrice={lastPrice} lastTick={lastTick} lastCandleClosed={lastCandleClosed} cross={cross} confirmedCross={confirmedCross} ema9={ema9} ema26={ema26} monitorEma1={monitorEma1} monitorEma2={monitorEma2} />\r\n\r\n              <Alerts\r\n                events={events}\r\n                removeAlertByTs={removeAlertByTs}\r\n                symbol={symbol}\r\n                symbolValid={symbolValid}\r\n                status={status}\r\n                connect={setServerAndConnect}\r\n                disconnect={disconnect}\r\n                monitorMinutes={monitorMinutes}\r\n                monitorEma1={monitorEma1}\r\n                monitorEma2={monitorEma2}\r\n                monitorConfirm={monitorConfirm}\r\n              />\r\n\r\n              <Notes>Notes: This app uses Binance public REST + websocket. Make sure network allows wss access to stream.binance.com.</Notes>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}