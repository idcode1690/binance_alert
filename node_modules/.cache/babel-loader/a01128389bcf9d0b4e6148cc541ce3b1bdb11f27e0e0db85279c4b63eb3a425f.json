{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef, useState, useCallback } from 'react';\nimport { calculateInitialEMA, updateEMA } from '../utils/ema';\n\n// Hook options: { symbol }\nexport default function useEmaCross({\n  symbol = 'BTCUSDT',\n  autoConnect = true\n} = {}) {\n  _s();\n  const [ema26, setEma26] = useState(null);\n  const [ema200, setEma200] = useState(null);\n  const [lastPrice, setLastPrice] = useState(null);\n  const [cross, setCross] = useState(null); // 'bull' | 'bear' | null\n  const [connected, setConnected] = useState(false);\n  const [status, setStatus] = useState('idle');\n  const [lastCandleClosed, setLastCandleClosed] = useState(false);\n  const [activeSymbol, setActiveSymbol] = useState(null); // which symbol the hook has initialized/connected for\n\n  const wsRef = useRef(null);\n  const prevCrossRef = useRef(null);\n  const ema26Ref = useRef(null);\n  const ema200Ref = useRef(null);\n  const reconnectAttemptsRef = useRef(0);\n  const reconnectTimerRef = useRef(null);\n  const currentSymbolRef = useRef(null);\n  const normalize = s => (s || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\n  const fetchAndInit = useCallback(async (target = symbol) => {\n    try {\n      const t = normalize(target || symbol);\n      console.debug('[useEmaCross] fetchAndInit target=', target, 'normalized=', t);\n      setStatus('fetching historical klines');\n      const url = `https://api.binance.com/api/v3/klines?symbol=${t}&interval=5m&limit=500`;\n      const res = await fetch(url);\n      if (!res.ok) throw new Error(`Failed to fetch klines: ${res.status}`);\n      const data = await res.json();\n      // kline array: [ openTime, open, high, low, close, ... ]\n      const closes = data.map(k => parseFloat(k[4]));\n      console.debug('[useEmaCross] fetched closes length=', closes.length);\n      if (closes.length < 200) throw new Error('Not enough historical candles to initialize EMA200');\n\n      // Use the full close history to compute EMA values\n      const initEma26 = calculateInitialEMA(closes.slice(-300), 26);\n      const initEma200 = calculateInitialEMA(closes.slice(-500), 200);\n      ema26Ref.current = initEma26;\n      ema200Ref.current = initEma200;\n      // record which symbol these EMAs correspond to\n      currentSymbolRef.current = t;\n      setActiveSymbol(t);\n      setEma26(initEma26);\n      setEma200(initEma200);\n      setLastPrice(closes[closes.length - 1]);\n      setStatus('initialized');\n      // set initial cross\n      const initialCross = initEma26 > initEma200 ? 'bull' : 'bear';\n      prevCrossRef.current = initialCross;\n      setCross(initialCross);\n    } catch (err) {\n      setStatus(`init error: ${err.message}`);\n      console.error(err);\n    }\n  }, [symbol]);\n  const connect = useCallback(async overrideSymbol => {\n    const targetSymbol = normalize(overrideSymbol || symbol);\n    // if a websocket exists for same symbol, no-op\n    if (wsRef.current) {\n      if (currentSymbolRef.current === targetSymbol) return;\n      try {\n        wsRef.current.close();\n      } catch (e) {}\n      wsRef.current = null;\n    }\n    // Ensure EMA is initialized for the target symbol before connecting\n    try {\n      if (currentSymbolRef.current !== targetSymbol || ema26Ref.current == null || ema200Ref.current == null) {\n        await fetchAndInit(targetSymbol);\n      }\n    } catch (err) {\n      setStatus(`init error: ${err.message}`);\n      return;\n    }\n    console.debug('[useEmaCross] connecting websocket for', targetSymbol);\n    setStatus('connecting websocket');\n    // Use combined stream: kline_5m + aggTrade for higher-frequency trade updates\n    const klineStream = `${targetSymbol.toLowerCase()}@kline_5m`;\n    const tradeStream = `${targetSymbol.toLowerCase()}@aggTrade`;\n    const streams = `${klineStream}/${tradeStream}`;\n    const url = `wss://stream.binance.com:9443/stream?streams=${streams}`;\n    console.log('Connecting websocket for', targetSymbol, 'url=', url);\n    const ws = new WebSocket(url);\n    wsRef.current = ws;\n    ws.onopen = () => {\n      // reset backoff attempts on successful open\n      reconnectAttemptsRef.current = 0;\n      if (reconnectTimerRef.current) {\n        clearTimeout(reconnectTimerRef.current);\n        reconnectTimerRef.current = null;\n      }\n      currentSymbolRef.current = targetSymbol;\n      setActiveSymbol(targetSymbol);\n      console.debug('[useEmaCross] websocket open for', targetSymbol);\n      setConnected(true);\n      setStatus('connected');\n    };\n    ws.onmessage = ev => {\n      try {\n        const payloadWrapper = JSON.parse(ev.data);\n        // combined stream returns { stream, data }\n        const payload = payloadWrapper.data || payloadWrapper;\n\n        // determine the source symbol for this message (if available)\n        let sourceSymbol = null;\n        try {\n          if (payload && payload.s) sourceSymbol = payload.s.toString().toUpperCase();else if (payloadWrapper && payloadWrapper.stream) {\n            const streamName = payloadWrapper.stream.toString(); // e.g. trxusdt@aggTrade\n            sourceSymbol = streamName.split('@')[0].toUpperCase();\n          }\n        } catch (e) {\n          sourceSymbol = null;\n        }\n\n        // If the message is not for the currently-initialized symbol, ignore it.\n        if (currentSymbolRef.current && sourceSymbol) {\n          if (currentSymbolRef.current.toString().toUpperCase() !== sourceSymbol.toString().toUpperCase()) {\n            return; // ignore messages from other symbols\n          }\n        }\n\n        // aggTrade messages have event type 'aggTrade' and price in p\n        if (payload.e === 'aggTrade') {\n          const price = parseFloat(payload.p);\n          setLastPrice(price);\n          if (ema26Ref.current == null || ema200Ref.current == null) return;\n\n          // update EMA using trade price to provide higher-frequency preview\n          const newEma26 = updateEMA(ema26Ref.current, price, 26);\n          const newEma200 = updateEMA(ema200Ref.current, price, 200);\n          ema26Ref.current = newEma26;\n          ema200Ref.current = newEma200;\n          setEma26(newEma26);\n          setEma200(newEma200);\n          const newCross = newEma26 > newEma200 ? 'bull' : 'bear';\n          if (prevCrossRef.current !== newCross) {\n            prevCrossRef.current = newCross;\n            setCross(newCross);\n          }\n        }\n\n        // kline messages contain a 'k' object\n        if (payload.k) {\n          const k = payload.k;\n          const close = parseFloat(k.c);\n          setLastPrice(close);\n          setLastCandleClosed(Boolean(k.x));\n          if (ema26Ref.current == null || ema200Ref.current == null) return;\n\n          // update EMA using kline close (partial or closed)\n          const newEma26 = updateEMA(ema26Ref.current, close, 26);\n          const newEma200 = updateEMA(ema200Ref.current, close, 200);\n          ema26Ref.current = newEma26;\n          ema200Ref.current = newEma200;\n          setEma26(newEma26);\n          setEma200(newEma200);\n          const newCross = newEma26 > newEma200 ? 'bull' : 'bear';\n          if (prevCrossRef.current !== newCross) {\n            prevCrossRef.current = newCross;\n            setCross(newCross);\n          }\n        }\n      } catch (err) {\n        console.error('ws message parse error', err, ev.data);\n      }\n    };\n    ws.onerror = e => {\n      console.error('ws error', e);\n      setStatus('websocket error');\n      // close to trigger backoff reconnect\n      try {\n        ws.close();\n      } catch (err) {}\n    };\n    ws.onclose = () => {\n      setConnected(false);\n      setStatus('websocket closed');\n      wsRef.current = null;\n      currentSymbolRef.current = null;\n      setActiveSymbol(null);\n      // exponential backoff reconnect with jitter\n      const attempt = reconnectAttemptsRef.current || 0;\n      const base = 1000; // 1s\n      const delay = Math.min(30000, base * Math.pow(2, attempt));\n      const jitter = Math.floor(Math.random() * 1000);\n      reconnectAttemptsRef.current = attempt + 1;\n      reconnectTimerRef.current = setTimeout(() => {\n        reconnectTimerRef.current = null;\n        if (!wsRef.current) {\n          // prefer reconnecting to the currently requested symbol if available\n          const target = currentSymbolRef.current || symbol;\n          try {\n            connect(target);\n          } catch (e) {\n            connect(target);\n          }\n        }\n      }, delay + jitter);\n    };\n  }, [symbol, fetchAndInit]);\n  const disconnect = useCallback(() => {\n    if (wsRef.current) {\n      wsRef.current.close();\n      wsRef.current = null;\n    }\n    setConnected(false);\n    setStatus('disconnected');\n    setActiveSymbol(null);\n    // clear reconnect attempts/timers\n    try {\n      reconnectAttemptsRef.current = 0;\n      if (reconnectTimerRef.current) {\n        clearTimeout(reconnectTimerRef.current);\n        reconnectTimerRef.current = null;\n      }\n    } catch (e) {}\n  }, []);\n  useEffect(() => {\n    // initialize on mount (or when symbol changes)\n    // Reset current state immediately so previous symbol's values don't show while new symbol initializes\n    try {\n      // close any existing websocket\n      if (wsRef.current) {\n        try {\n          wsRef.current.close();\n        } catch (e) {}\n        wsRef.current = null;\n      }\n\n      // clear reconnect timers and attempts\n      if (reconnectTimerRef.current) {\n        clearTimeout(reconnectTimerRef.current);\n        reconnectTimerRef.current = null;\n      }\n      reconnectAttemptsRef.current = 0;\n\n      // reset refs and state for EMA and cross\n      prevCrossRef.current = null;\n      currentSymbolRef.current = null;\n      ema26Ref.current = null;\n      ema200Ref.current = null;\n      setActiveSymbol(null);\n      setEma26(null);\n      setEma200(null);\n      setLastPrice(null);\n      setCross(null);\n      setLastCandleClosed(false);\n      setConnected(false);\n      setStatus('reloading');\n    } catch (e) {}\n    // fetch history for the (new) symbol and initialize\n    fetchAndInit();\n    // cleanup on unmount\n    return () => {\n      if (wsRef.current) wsRef.current.close();\n    };\n  }, [fetchAndInit]);\n\n  // auto connect after initialization if requested\n  useEffect(() => {\n    if (status === 'initialized' && autoConnect) {\n      // call connect once after initialization\n      connect();\n    }\n    // only run when status or autoConnect changes\n  }, [status, autoConnect, connect]);\n  return {\n    ema26,\n    ema200,\n    lastPrice,\n    lastCandleClosed,\n    cross,\n    connected,\n    status,\n    connect,\n    disconnect,\n    activeSymbol\n  };\n}\n_s(useEmaCross, \"Kalf5R5sb2BSY0lg8fpnvlHtuVw=\");","map":{"version":3,"names":["useEffect","useRef","useState","useCallback","calculateInitialEMA","updateEMA","useEmaCross","symbol","autoConnect","_s","ema26","setEma26","ema200","setEma200","lastPrice","setLastPrice","cross","setCross","connected","setConnected","status","setStatus","lastCandleClosed","setLastCandleClosed","activeSymbol","setActiveSymbol","wsRef","prevCrossRef","ema26Ref","ema200Ref","reconnectAttemptsRef","reconnectTimerRef","currentSymbolRef","normalize","s","toString","replace","toUpperCase","fetchAndInit","target","t","console","debug","url","res","fetch","ok","Error","data","json","closes","map","k","parseFloat","length","initEma26","slice","initEma200","current","initialCross","err","message","error","connect","overrideSymbol","targetSymbol","close","e","klineStream","toLowerCase","tradeStream","streams","log","ws","WebSocket","onopen","clearTimeout","onmessage","ev","payloadWrapper","JSON","parse","payload","sourceSymbol","stream","streamName","split","price","p","newEma26","newEma200","newCross","c","Boolean","x","onerror","onclose","attempt","base","delay","Math","min","pow","jitter","floor","random","setTimeout","disconnect"],"sources":["C:/Users/e1it3/Desktop/program/binance_alert/src/hooks/useEmaCross.js"],"sourcesContent":["import { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { calculateInitialEMA, updateEMA } from '../utils/ema';\r\n\r\n// Hook options: { symbol }\r\nexport default function useEmaCross({ symbol = 'BTCUSDT', autoConnect = true } = {}) {\r\n  const [ema26, setEma26] = useState(null);\r\n  const [ema200, setEma200] = useState(null);\r\n  const [lastPrice, setLastPrice] = useState(null);\r\n  const [cross, setCross] = useState(null); // 'bull' | 'bear' | null\r\n  const [connected, setConnected] = useState(false);\r\n  const [status, setStatus] = useState('idle');\r\n  const [lastCandleClosed, setLastCandleClosed] = useState(false);\r\n  const [activeSymbol, setActiveSymbol] = useState(null); // which symbol the hook has initialized/connected for\r\n\r\n  const wsRef = useRef(null);\r\n  const prevCrossRef = useRef(null);\r\n  const ema26Ref = useRef(null);\r\n  const ema200Ref = useRef(null);\r\n  const reconnectAttemptsRef = useRef(0);\r\n  const reconnectTimerRef = useRef(null);\r\n  const currentSymbolRef = useRef(null);\r\n\r\n  const normalize = (s) => (s || '').toString().replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n\r\n  const fetchAndInit = useCallback(async (target = symbol) => {\r\n    try {\r\n      const t = normalize(target || symbol);\r\n      console.debug('[useEmaCross] fetchAndInit target=', target, 'normalized=', t);\r\n      setStatus('fetching historical klines');\r\n      const url = `https://api.binance.com/api/v3/klines?symbol=${t}&interval=5m&limit=500`;\r\n      const res = await fetch(url);\r\n      if (!res.ok) throw new Error(`Failed to fetch klines: ${res.status}`);\r\n      const data = await res.json();\r\n      // kline array: [ openTime, open, high, low, close, ... ]\r\n  const closes = data.map((k) => parseFloat(k[4]));\r\n\r\n      console.debug('[useEmaCross] fetched closes length=', closes.length);\r\n      if (closes.length < 200) throw new Error('Not enough historical candles to initialize EMA200');\r\n\r\n      // Use the full close history to compute EMA values\r\n      const initEma26 = calculateInitialEMA(closes.slice(-300), 26);\r\n      const initEma200 = calculateInitialEMA(closes.slice(-500), 200);\r\n\r\n  ema26Ref.current = initEma26;\r\n  ema200Ref.current = initEma200;\r\n  // record which symbol these EMAs correspond to\r\n    currentSymbolRef.current = t;\r\n    setActiveSymbol(t);\r\n      setEma26(initEma26);\r\n      setEma200(initEma200);\r\n      setLastPrice(closes[closes.length - 1]);\r\n      setStatus('initialized');\r\n      // set initial cross\r\n      const initialCross = initEma26 > initEma200 ? 'bull' : 'bear';\r\n      prevCrossRef.current = initialCross;\r\n      setCross(initialCross);\r\n    } catch (err) {\r\n      setStatus(`init error: ${err.message}`);\r\n      console.error(err);\r\n    }\r\n  }, [symbol]);\r\n\r\n  const connect = useCallback(async (overrideSymbol) => {\r\n    const targetSymbol = normalize(overrideSymbol || symbol);\r\n    // if a websocket exists for same symbol, no-op\r\n    if (wsRef.current) {\r\n      if (currentSymbolRef.current === targetSymbol) return;\r\n      try { wsRef.current.close(); } catch (e) {}\r\n      wsRef.current = null;\r\n    }\r\n    // Ensure EMA is initialized for the target symbol before connecting\r\n    try {\r\n      if (currentSymbolRef.current !== targetSymbol || ema26Ref.current == null || ema200Ref.current == null) {\r\n        await fetchAndInit(targetSymbol);\r\n      }\r\n    } catch (err) {\r\n      setStatus(`init error: ${err.message}`);\r\n      return;\r\n    }\r\n\r\n    console.debug('[useEmaCross] connecting websocket for', targetSymbol);\r\n    setStatus('connecting websocket');\r\n    // Use combined stream: kline_5m + aggTrade for higher-frequency trade updates\r\n    const klineStream = `${targetSymbol.toLowerCase()}@kline_5m`;\r\n    const tradeStream = `${targetSymbol.toLowerCase()}@aggTrade`;\r\n    const streams = `${klineStream}/${tradeStream}`;\r\n    const url = `wss://stream.binance.com:9443/stream?streams=${streams}`;\r\n  console.log('Connecting websocket for', targetSymbol, 'url=', url);\r\n  const ws = new WebSocket(url);\r\n    wsRef.current = ws;\r\n\r\n    ws.onopen = () => {\r\n      // reset backoff attempts on successful open\r\n      reconnectAttemptsRef.current = 0;\r\n      if (reconnectTimerRef.current) {\r\n        clearTimeout(reconnectTimerRef.current);\r\n        reconnectTimerRef.current = null;\r\n      }\r\n      currentSymbolRef.current = targetSymbol;\r\n      setActiveSymbol(targetSymbol);\r\n      console.debug('[useEmaCross] websocket open for', targetSymbol);\r\n      setConnected(true);\r\n      setStatus('connected');\r\n    };\r\n\r\n    ws.onmessage = (ev) => {\r\n      try {\r\n        const payloadWrapper = JSON.parse(ev.data);\r\n        // combined stream returns { stream, data }\r\n        const payload = payloadWrapper.data || payloadWrapper;\r\n\r\n        // determine the source symbol for this message (if available)\r\n        let sourceSymbol = null;\r\n        try {\r\n          if (payload && payload.s) sourceSymbol = payload.s.toString().toUpperCase();\r\n          else if (payloadWrapper && payloadWrapper.stream) {\r\n            const streamName = payloadWrapper.stream.toString(); // e.g. trxusdt@aggTrade\r\n            sourceSymbol = streamName.split('@')[0].toUpperCase();\r\n          }\r\n        } catch (e) { sourceSymbol = null; }\r\n\r\n        // If the message is not for the currently-initialized symbol, ignore it.\r\n        if (currentSymbolRef.current && sourceSymbol) {\r\n          if (currentSymbolRef.current.toString().toUpperCase() !== sourceSymbol.toString().toUpperCase()) {\r\n            return; // ignore messages from other symbols\r\n          }\r\n        }\r\n\r\n        // aggTrade messages have event type 'aggTrade' and price in p\r\n        if (payload.e === 'aggTrade') {\r\n          const price = parseFloat(payload.p);\r\n          setLastPrice(price);\r\n\r\n          if (ema26Ref.current == null || ema200Ref.current == null) return;\r\n\r\n          // update EMA using trade price to provide higher-frequency preview\r\n          const newEma26 = updateEMA(ema26Ref.current, price, 26);\r\n          const newEma200 = updateEMA(ema200Ref.current, price, 200);\r\n          ema26Ref.current = newEma26;\r\n          ema200Ref.current = newEma200;\r\n          setEma26(newEma26);\r\n          setEma200(newEma200);\r\n\r\n          const newCross = newEma26 > newEma200 ? 'bull' : 'bear';\r\n          if (prevCrossRef.current !== newCross) {\r\n            prevCrossRef.current = newCross;\r\n            setCross(newCross);\r\n          }\r\n        }\r\n\r\n        // kline messages contain a 'k' object\r\n        if (payload.k) {\r\n          const k = payload.k;\r\n          const close = parseFloat(k.c);\r\n          setLastPrice(close);\r\n          setLastCandleClosed(Boolean(k.x));\r\n\r\n          if (ema26Ref.current == null || ema200Ref.current == null) return;\r\n\r\n          // update EMA using kline close (partial or closed)\r\n          const newEma26 = updateEMA(ema26Ref.current, close, 26);\r\n          const newEma200 = updateEMA(ema200Ref.current, close, 200);\r\n          ema26Ref.current = newEma26;\r\n          ema200Ref.current = newEma200;\r\n          setEma26(newEma26);\r\n          setEma200(newEma200);\r\n\r\n          const newCross = newEma26 > newEma200 ? 'bull' : 'bear';\r\n          if (prevCrossRef.current !== newCross) {\r\n            prevCrossRef.current = newCross;\r\n            setCross(newCross);\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error('ws message parse error', err, ev.data);\r\n      }\r\n    };\r\n\r\n    ws.onerror = (e) => {\r\n      console.error('ws error', e);\r\n      setStatus('websocket error');\r\n      // close to trigger backoff reconnect\r\n      try { ws.close(); } catch (err) {}\r\n    };\r\n\r\n    ws.onclose = () => {\r\n      setConnected(false);\r\n      setStatus('websocket closed');\r\n      wsRef.current = null;\r\n      currentSymbolRef.current = null;\r\n      setActiveSymbol(null);\r\n      // exponential backoff reconnect with jitter\r\n      const attempt = reconnectAttemptsRef.current || 0;\r\n      const base = 1000; // 1s\r\n      const delay = Math.min(30000, base * Math.pow(2, attempt));\r\n      const jitter = Math.floor(Math.random() * 1000);\r\n      reconnectAttemptsRef.current = attempt + 1;\r\n      reconnectTimerRef.current = setTimeout(() => {\r\n        reconnectTimerRef.current = null;\r\n        if (!wsRef.current) {\r\n          // prefer reconnecting to the currently requested symbol if available\r\n          const target = currentSymbolRef.current || symbol;\r\n          try { connect(target); } catch (e) { connect(target); }\r\n        }\r\n      }, delay + jitter);\r\n    };\r\n  }, [symbol, fetchAndInit]);\r\n\r\n  const disconnect = useCallback(() => {\r\n    if (wsRef.current) {\r\n      wsRef.current.close();\r\n      wsRef.current = null;\r\n    }\r\n    setConnected(false);\r\n    setStatus('disconnected');\r\n    setActiveSymbol(null);\r\n    // clear reconnect attempts/timers\r\n    try {\r\n      reconnectAttemptsRef.current = 0;\r\n      if (reconnectTimerRef.current) {\r\n        clearTimeout(reconnectTimerRef.current);\r\n        reconnectTimerRef.current = null;\r\n      }\r\n    } catch (e) {}\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // initialize on mount (or when symbol changes)\r\n    // Reset current state immediately so previous symbol's values don't show while new symbol initializes\r\n    try {\r\n      // close any existing websocket\r\n      if (wsRef.current) {\r\n        try { wsRef.current.close(); } catch (e) {}\r\n        wsRef.current = null;\r\n      }\r\n\r\n      // clear reconnect timers and attempts\r\n      if (reconnectTimerRef.current) {\r\n        clearTimeout(reconnectTimerRef.current);\r\n        reconnectTimerRef.current = null;\r\n      }\r\n      reconnectAttemptsRef.current = 0;\r\n\r\n      // reset refs and state for EMA and cross\r\n      prevCrossRef.current = null;\r\n      currentSymbolRef.current = null;\r\n      ema26Ref.current = null;\r\n      ema200Ref.current = null;\r\n  setActiveSymbol(null);\r\n      setEma26(null);\r\n      setEma200(null);\r\n      setLastPrice(null);\r\n      setCross(null);\r\n      setLastCandleClosed(false);\r\n      setConnected(false);\r\n      setStatus('reloading');\r\n    } catch (e) {}\r\n    // fetch history for the (new) symbol and initialize\r\n    fetchAndInit();\r\n    // cleanup on unmount\r\n    return () => {\r\n      if (wsRef.current) wsRef.current.close();\r\n    };\r\n  }, [fetchAndInit]);\r\n\r\n  // auto connect after initialization if requested\r\n  useEffect(() => {\r\n    if (status === 'initialized' && autoConnect) {\r\n      // call connect once after initialization\r\n      connect();\r\n    }\r\n    // only run when status or autoConnect changes\r\n  }, [status, autoConnect, connect]);\r\n\r\n  return {\r\n    ema26,\r\n    ema200,\r\n    lastPrice,\r\n    lastCandleClosed,\r\n    cross,\r\n    connected,\r\n    status,\r\n    connect,\r\n    disconnect,\r\n    activeSymbol,\r\n  };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}